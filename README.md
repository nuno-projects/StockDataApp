# StockDataApp

This document provides an overview of the database schema for the `StockDataApp`, outlining the tables, their structure, and relationships.

## Database Tables

### List of Relations

| Schema | Name       | Type  | Owner |
|--------|------------|-------|-------|
| public | app_user   | table | nuno  |
| public | operation  | table | nuno  |
| public | portfolio  | table | nuno  |
| public | stock      | table | nuno  |

---

### Table: `app_user`

This table holds information about users of the application.

| Column        | Type                   | Nullable | Default                               |
|---------------|------------------------|----------|---------------------------------------|
| id            | bigint                 | not null | generated by default as identity      |
| total_invested| double precision       |          |                                       |
| username      | character varying(255) |          |                                       |

**Indexes**:
- `app_user_pkey`: Primary key, btree (id)

**Foreign Keys**:
- Referenced by:
    - `portfolio` table, `fk6oqgd26c6y8e74gdk0gb8hmgy`: Foreign key (user_id) references `app_user(id)`

---

### Table: `operation`

This table records the various operations (e.g., buying and selling of stocks) in user portfolios.

| Column                 | Type                            | Nullable | Default                               |
|------------------------|---------------------------------|----------|---------------------------------------|
| dtype                  | character varying(31)           | not null |                                       |
| id                     | bigint                          | not null | generated by default as identity      |
| amount                 | double precision                |          |                                       |
| operation_date         | timestamp(6) without time zone  |          |                                       |
| operation_type         | character varying(255)          |          |                                       |
| price                  | double precision                |          |                                       |
| total_cost             | double precision                |          |                                       |
| total_amount_spent      | double precision                |          |                                       |
| total_amount_received   | double precision                |          |                                       |
| portfolio_id           | bigint                          |          |                                       |
| stock_id               | bigint                          |          |                                       |

**Indexes**:
- `operation_pkey`: Primary key, btree (id)

**Check Constraints**:
- `operation_operation_type_check`: Ensures `operation_type` is either 'BUY' or 'SELL'.

**Foreign Keys**:
- `fk24q2r7fqlx24fu0nt18wsbr2n`: Foreign key (stock_id) references `stock(id)`
- `fkmx7i3jy70tymr1lhqm7kccneo`: Foreign key (portfolio_id) references `portfolio(id)`

---

### Table: `portfolio`

This table stores information about users' portfolios, including total value and the user to whom it belongs.

| Column        | Type                   | Nullable | Default                               |
|---------------|------------------------|----------|---------------------------------------|
| id            | bigint                 | not null | generated by default as identity      |
| dividend_yield| double precision       |          |                                       |
| name          | character varying(255) |          |                                       |
| total_value   | double precision       |          |                                       |
| user_id       | bigint                 |          |                                       |

**Indexes**:
- `portfolio_pkey`: Primary key, btree (id)

**Foreign Keys**:
- `fk6oqgd26c6y8e74gdk0gb8hmgy`: Foreign key (user_id) references `app_user(id)`

**Referenced by**:
- `operation` table, `fkmx7i3jy70tymr1lhqm7kccneo`: Foreign key (portfolio_id) references `portfolio(id)`

---

### Table: `stock`

This table contains information about various stocks available for trading.

| Column                 | Type                   | Nullable | Default                               |
|------------------------|------------------------|----------|---------------------------------------|
| id                     | bigint                 | not null | generated by default as identity      |
| dcf_fair_value          | double precision       |          |                                       |
| dividend_yield          | double precision       |          |                                       |
| market_cap              | double precision       |          |                                       |
| num_shares              | bigint                 |          |                                       |
| price                  | double precision        |          |                                       |
| symbol                 | character varying(255) | not null |                                       |
| total_cash_equivalents  | double precision       |          |                                       |
| total_debt              | double precision       |          |                                       |

**Indexes**:
- `stock_pkey`: Primary key, btree (id)
- `uka86fxhchlsurngwa05iqbcw7b`: Unique constraint, btree (symbol)

**Foreign Keys**:
- Referenced by:
    - `operation` table, `fk24q2r7fqlx24fu0nt18wsbr2n`: Foreign key (stock_id) references `stock(id)`

---

## Relationships Summary

- **User (`app_user`) ↔ Portfolio (`portfolio`)**: One-to-many relationship. A user can have multiple portfolios.
- **Portfolio (`portfolio`) ↔ Operation (`operation`)**: One-to-many relationship. A portfolio can have multiple operations.
- **Stock (`stock`) ↔ Operation (`operation`)**: One-to-many relationship. A stock can be associated with multiple operations (buys/sells).

